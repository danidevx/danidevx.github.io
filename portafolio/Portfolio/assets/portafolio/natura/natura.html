<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tienda Naturista</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            cursor: none; /* Nuevo: cursor personalizado */
        }

        /* Cursor personalizado */
        .custom-cursor {
            position: fixed;
            width: 20px;
            height: 20px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9999;
            mix-blend-mode: difference;
            transition: transform 0.1s ease;
        }

        .custom-cursor-follower {
            position: fixed;
            width: 40px;
            height: 40px;
            border: 2px solid rgba(255, 255, 255, 0.4);
            border-radius: 50%;
            pointer-events: none;
            z-index: 9998;
            transition: all 0.15s ease-out;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            height: 100vh;
            overflow: hidden;
            position: relative;
        }

        /* Fondo con transición para el blur */
        .background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://images.unsplash.com/photo-1579783902614-a3fb3927b6a5?w=1920&q=80') center/cover no-repeat;
            transition: filter 0.6s ease;
            z-index: -1;
        }

        .background.blurred {
            filter: blur(8px);
        }

        .background::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            z-index: 0;
        }

        .container {
            position: relative;
            z-index: 1;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header con tabs */
        .header {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px 0;
            gap: 20px;
        }

        .tab {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 15px 50px;
            border-radius: 20px;
            color: white;
            font-size: 22px;
            font-weight: 600;
            cursor: none;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .tab:hover {
            background: rgba(255, 255, 255, 0.25);
            transform: translateY(-2px);
        }

        .tab.active {
            background: rgba(255, 255, 255, 0.35);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        /* Carrito */
        .cart {
            position: fixed;
            top: 40px;
            right: 40px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: none;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            z-index: 100;
        }

        .cart:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .cart-icon {
            font-size: 28px;
        }

        .cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ff4757;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        /* Contenido */
        .content {
            flex: 1;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            padding: 0 60px 60px;
            position: relative;
        }

        .tab-content {
            display: none;
            width: 100%;
        }

        .tab-content.active {
            display: block;
        }

        /* Productos Grid */
        .products-grid {
            display: flex;
            gap: 30px;
            justify-content: center;
        }

        .product-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 20px;
            padding: 0;
            width: 140px;
            cursor: none;
            transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            position: relative;
            z-index: 2;
            overflow: hidden;
            opacity: 0.9;
        }

        .product-card:hover {
            transform: translateY(-5px) scale(1.02);
            opacity: 1;
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .product-card.expanded {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(1.5);
            width: 300px;
            z-index: 1001;
            background: rgba(255, 255, 255, 0.25);
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            transition: all 0.6s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        }

        .product-image {
            width: 100%;
            height: 140px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 50px;
            position: relative;
            transition: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            overflow: hidden;
        }

        .product-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .product-card:hover .product-image img {
            transform: scale(1.1);
        }

        .product-card.expanded .product-image {
            height: 180px;
            font-size: 70px;
        }

        .product-name {
            position: absolute;
            bottom: 8px;
            left: 8px;
            right: 8px;
            color: white;
            font-size: 12px;
            font-weight: 700;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.8);
            text-align: center;
            transition: all 0.4s ease;
            background: rgba(0, 0, 0, 0.5);
            padding: 5px;
            border-radius: 10px;
        }

        .product-price {
            position: absolute;
            top: 8px;
            left: 8px;
            color: #ffd700;
            font-size: 16px;
            font-weight: bold;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.8);
            transition: all 0.4s ease;
            background: rgba(0, 0, 0, 0.5);
            padding: 5px 10px;
            border-radius: 10px;
        }

        .btn-add {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(76, 209, 55, 0.9);
            backdrop-filter: blur(10px);
            border: none;
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            font-size: 20px;
            font-weight: bold;
            cursor: none;
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            z-index: 3;
        }

        .product-description {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            line-height: 1.5;
            margin-bottom: 15px;
            display: none;
            padding: 15px;
            opacity: 0;
            transition: opacity 0.4s ease 0.2s;
        }

        .product-card.expanded .product-description {
            display: block;
            opacity: 1;
        }

        .product-actions {
            display: none;
        }

        .btn-add:hover {
            background: rgba(76, 209, 55, 1);
            transform: scale(1.1);
        }

        /* Overlay */
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            z-index: 10;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .overlay.active {
            display: block;
            opacity: 1;
        }

        /* CORRECCIÓN: Discount badge reposicionado */
        .discount-badge {
            position: absolute;
            top: 8px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #ff6b6b, #ff4757);
            color: white;
            padding: 6px 12px;
            border-radius: 15px;
            font-weight: bold;
            font-size: 12px;
            transition: all 0.4s ease;
            z-index: 3;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            white-space: nowrap;
        }

        /* Modal del Carrito */
        .cart-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            z-index: 1002;
            overflow: hidden;
            flex-direction: column;
        }

        .cart-modal.active {
            display: flex;
        }

        .cart-header {
            padding: 20px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-title {
            font-size: 24px;
            font-weight: bold;
            color: #2d3436;
        }

        .close-cart {
            background: none;
            border: none;
            font-size: 24px;
            cursor: none;
            color: #636e72;
            transition: color 0.3s;
        }

        .close-cart:hover {
            color: #2d3436;
        }

        .cart-items {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .cart-item {
            display: flex;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .cart-item:last-child {
            border-bottom: none;
        }

        .cart-item-image {
            width: 60px;
            height: 60px;
            background: rgba(116, 185, 255, 0.2);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-right: 15px;
            overflow: hidden;
        }

        .cart-item-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .cart-item-details {
            flex: 1;
        }

        .cart-item-name {
            font-weight: bold;
            color: #2d3436;
            margin-bottom: 5px;
        }

        .cart-item-price {
            color: #636e72;
            font-size: 14px;
        }

        .cart-item-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quantity-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: none;
            background: #74b9ff;
            color: white;
            font-weight: bold;
            cursor: none;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }

        .quantity-btn:hover {
            background: #0984e3;
        }

        .quantity-btn.remove {
            background: #ff7675;
        }

        .quantity-btn.remove:hover {
            background: #d63031;
        }

        .item-quantity {
            font-weight: bold;
            min-width: 30px;
            text-align: center;
        }

        .cart-footer {
            padding: 20px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-total {
            font-size: 20px;
            font-weight: bold;
            color: #2d3436;
        }

        .checkout-btn {
            background: #00b894;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            font-weight: bold;
            cursor: none;
            transition: background 0.3s;
        }

        .checkout-btn:hover {
            background: #00a085;
        }

        .empty-cart {
            text-align: center;
            padding: 40px 20px;
            color: #636e72;
        }

        .empty-cart-icon {
            font-size: 50px;
            margin-bottom: 15px;
        }

        .cart-modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1001;
        }

        .cart-modal-overlay.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Cursor personalizado -->
    <div class="custom-cursor"></div>
    <div class="custom-cursor-follower"></div>
    
    <!-- Fondo separado para aplicar solo a él el blur -->
    <div class="background"></div>
    
    <div class="container">
        <div class="header">
            <div class="tab active" data-tab="productos">Productos</div>
            <div class="tab" data-tab="ofertas">Ofertas</div>
        </div>

        <div class="cart" onclick="showCart()">
            <span class="cart-icon">🛒</span>
            <span class="cart-count">0</span>
        </div>

        <div class="content">
            <!-- Tab Productos -->
            <div class="tab-content active" id="productos">
                <div class="products-grid">
                    <div class="product-card">
                        <div class="product-image">
                            <img src="https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=400&h=300&fit=crop" alt="Té Verde Orgánico">
                            <div class="product-price">$15.99</div>
                            <div class="product-name">Té Verde Orgánico</div>
                            <button class="btn-add" onclick="addToCart(event, 'Té Verde Orgánico', 15.99, 'https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=400&h=300&fit=crop')">+</button>
                        </div>
                        <div class="product-description">Té verde 100% orgánico, rico en antioxidantes. Ideal para mejorar la digestión y aumentar la energía naturalmente.</div>
                    </div>

                    <div class="product-card">
                        <div class="product-image">
                            <img src="https://img.freepik.com/fotos-premium/monton-capsulas-omega-3-sobre-fondo-negro_176402-9354.jpg" alt="Omega-3 Premium">
                            <div class="product-price">$24.99</div>
                            <div class="product-name">Omega-3 Premium</div>
                            <button class="btn-add" onclick="addToCart(event, 'Omega-3 Premium', 24.99, 'https://images.unsplash.com/photo-1599084993091-1cb5c0721cc6?w=400&h=300&fit=crop')">+</button>
                        </div>
                        <div class="product-description">Cápsulas de aceite de pescado de alta calidad. Apoya la salud cardiovascular y función cerebral óptima.</div>
                    </div>

                    <div class="product-card">
                        <div class="product-image">
                            <img src="https://le-de.cdn-website.com/301842f25a9c469cbd61ab0c6c23804b/dms3rep/multi/opt/MIEL-MANUKA-cuchara-con-miel-430w.jpg" alt="Miel de Manuka">
                            <div class="product-price">$32.99</div>
                            <div class="product-name">Miel de Manuka</div>
                            <button class="btn-add" onclick="addToCart(event, 'Miel de Manuka', 32.99, 'https://images.unsplash.com/photo-1587049633312-d628ae50a8ae?w=400&h=300&fit=crop')">+</button>
                        </div>
                        <div class="product-description">Miel pura de Manuka con propiedades antibacterianas naturales. Perfecta para fortalecer el sistema inmune.</div>
                    </div>

                    <div class="product-card">
                        <div class="product-image">
                            <img src="https://images.unsplash.com/photo-1621447504864-d8686e12698c?w=400&h=300&fit=crop" alt="Proteína Vegana">
                            <div class="product-price">$28.99</div>
                            <div class="product-name">Proteína Vegana</div>
                            <button class="btn-add" onclick="addToCart(event, 'Proteína Vegana', 28.99, 'https://images.unsplash.com/photo-1621447504864-d8686e12698c?w=400&h=300&fit=crop')">+</button>
                        </div>
                        <div class="product-description">Proteína en polvo 100% vegetal de guisantes y arroz. Ideal para deportistas y dietas plant-based.</div>
                    </div>
                </div>
            </div>

            <!-- Tab Ofertas -->
            <div class="tab-content" id="ofertas">
                <div class="products-grid">
                    <div class="product-card">
                        <div class="discount-badge">-30%</div>
                        <div class="product-image">
                            <img src="https://images.unsplash.com/photo-1515823064-d6e0c04616a7?w=400&h=300&fit=crop" alt="Té Matcha Premium">
                            <div class="product-price">$18.99</div>
                            <div class="product-name">Té Matcha Premium</div>
                            <button class="btn-add" onclick="addToCart(event, 'Té Matcha Premium', 18.99, 'https://images.unsplash.com/photo-1515823064-d6e0c04616a7?w=400&h=300&fit=crop')">+</button>
                        </div>
                        <div class="product-description">Matcha japonés de grado ceremonial. Rico en antioxidantes y perfecto para lattes cremosos y energizantes.</div>
                    </div>

                    <div class="product-card">
                        <div class="discount-badge">-25%</div>
                        <div class="product-image">
                            <img src="https://media.gettyimages.com/id/1024835372/es/foto/coconut-oil.jpg?s=612x612&w=0&k=20&c=-0YMdl030mHI_aYOcUHIHcAJyBcuzbPlTtRe7l4WhK4=" alt="Aceite de Coco">
                            <div class="product-price">$12.99</div>
                            <div class="product-name">Aceite de Coco</div>
                            <button class="btn-add" onclick="addToCart(event, 'Aceite de Coco', 12.99, 'https://images.unsplash.com/photo-1600271787857-5c2494ee0e7a?w=400&h=300&fit=crop')">+</button>
                        </div>
                        <div class="product-description">Aceite de coco virgen extra orgánico. Perfecto para cocinar, cuidado de la piel y cabello saludable.</div>
                    </div>

                    <div class="product-card">
                        <div class="discount-badge">-40%</div>
                        <div class="product-image">
                            <img src="https://img.freepik.com/foto-gratis/vista-superior-nueces-mezcla-recipiente-sobre-fondo-madera_1150-1870.jpg?semt=ais_hybrid&w=740&q=80" alt="Mix de Frutos Secos">
                            <div class="product-price">$9.99</div>
                            <div class="product-name">Mix de Frutos Secos</div>
                            <button class="btn-add" onclick="addToCart(event, 'Mix de Frutos Secos', 9.99, 'https://images.unsplash.com/photo-1542838132-92c53300491e?w=400&h=300&fit=crop')">+</button>
                        </div>
                        <div class="product-description">Mezcla premium de almendras, nueces y arándanos. Snack saludable rico en proteínas y grasas saludables.</div>
                    </div>

                    <div class="product-card">
                        <div class="discount-badge">-20%</div>
                        <div class="product-image">
                            <img src="https://st2.depositphotos.com/7319422/44321/i/450/depositphotos_443217256-stock-photo-collagen-powder-bowl-glass-water.jpg" alt="Colágeno Marino">
                            <div class="product-price">$29.99</div>
                            <div class="product-name">Colágeno Marino</div>
                            <button class="btn-add" onclick="addToCart(event, 'Colágeno Marino', 29.99, 'https://images.unsplash.com/photo-1596040033229-a9821ebd058d?w=400&h=300&fit=crop')">+</button>
                        </div>
                        <div class="product-description">Colágeno hidrolizado de origen marino. Apoya la salud de piel, cabello, uñas y articulaciones.</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="overlay" onclick="closeExpanded()"></div>
    
    <!-- Modal del Carrito -->
    <div class="cart-modal-overlay" onclick="closeCart()"></div>
    <div class="cart-modal">
        <div class="cart-header">
            <h2 class="cart-title">Tu Carrito de Compras</h2>
            <button class="close-cart" onclick="closeCart()">×</button>
        </div>
        <div class="cart-items" id="cart-items">
            <!-- Los elementos del carrito se insertarán aquí -->
        </div>
        <div class="cart-footer">
            <div class="cart-total">Total: $<span id="cart-total">0.00</span></div>
            <button class="checkout-btn" onclick="checkout()">Finalizar Compra</button>
        </div>
    </div>

    <script>
        let cartCount = 0;
        let cartItems = [];
        let cartTotal = 0;

        // Sistema de cursor personalizado
        const cursor = document.querySelector('.custom-cursor');
        const cursorFollower = document.querySelector('.custom-cursor-follower');

        document.addEventListener('mousemove', (e) => {
            cursor.style.left = e.clientX + 'px';
            cursor.style.top = e.clientY + 'px';
            
            setTimeout(() => {
                cursorFollower.style.left = e.clientX + 'px';
                cursorFollower.style.top = e.clientY + 'px';
            }, 100);
        });

        // Efectos de hover para el cursor
        document.querySelectorAll('button, .tab, .cart, .product-card').forEach(element => {
            element.addEventListener('mouseenter', () => {
                cursor.style.transform = 'scale(1.5)';
                cursorFollower.style.transform = 'scale(1.3)';
                cursorFollower.style.borderColor = 'rgba(255, 255, 255, 0.8)';
            });
            
            element.addEventListener('mouseleave', () => {
                cursor.style.transform = 'scale(1)';
                cursorFollower.style.transform = 'scale(1)';
                cursorFollower.style.borderColor = 'rgba(255, 255, 255, 0.4)';
            });
        });

        // Función para cerrar productos expandidos y remover blur
        function closeExpanded() {
            document.querySelectorAll('.product-card').forEach(c => c.classList.remove('expanded'));
            document.querySelector('.overlay').classList.remove('active');
            document.querySelector('.background').classList.remove('blurred');
        }

        // Función para cambiar pestañas
        function switchTab(tabElement) {
            // Cerrar cualquier producto expandido antes de cambiar de pestaña
            closeExpanded();
            
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            tabElement.classList.add('active');
            document.getElementById(tabElement.dataset.tab).classList.add('active');
        }

        // Cambiar entre tabs al hacer clic
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                switchTab(this);
            });
        });

        // Cambiar entre tabs al pasar el cursor
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('mouseenter', function() {
                switchTab(this);
            });
        });

        let isExpanding = false;
        
        // Expandir al hacer hover sobre producto
        document.querySelectorAll('.product-card').forEach(card => {
            card.addEventListener('mouseenter', function() {
                if (isExpanding) return;
                
                const overlay = document.querySelector('.overlay');
                const background = document.querySelector('.background');
                
                // Cerrar cualquier expandido
                document.querySelectorAll('.product-card').forEach(c => c.classList.remove('expanded'));
                
                // Expandir el actual
                this.classList.add('expanded');
                overlay.classList.add('active');
                background.classList.add('blurred'); // MODIFICADO: aplicar blur solo al fondo
                isExpanding = true;
                
                // Resetear flag después de la animación
                setTimeout(() => {
                    isExpanding = false;
                }, 600);
            });
        });

        // Agregar al carrito
        function addToCart(event, productName, price, imageUrl) {
            event.stopPropagation();
            
            // Verificar si el producto ya está en el carrito
            const existingItem = cartItems.find(item => item.name === productName);
            
            if (existingItem) {
                // Si ya existe, aumentar la cantidad
                existingItem.quantity += 1;
            } else {
                // Si no existe, agregar nuevo producto
                cartItems.push({
                    name: productName,
                    price: price,
                    quantity: 1,
                    imageUrl: imageUrl
                });
            }
            
            // Actualizar contador del carrito
            updateCartCount();
            
            // Animación del carrito
            const cart = document.querySelector('.cart');
            cart.style.transform = 'scale(1.15)';
            setTimeout(() => {
                cart.style.transform = 'scale(1)';
            }, 300);
        }

        // Actualizar contador del carrito
        function updateCartCount() {
            cartCount = cartItems.reduce((total, item) => total + item.quantity, 0);
            document.querySelector('.cart-count').textContent = cartCount;
        }

        // Mostrar carrito
        function showCart() {
            const cartModal = document.querySelector('.cart-modal');
            const cartOverlay = document.querySelector('.cart-modal-overlay');
            const background = document.querySelector('.background');
            
            // Aplicar blur al fondo
            background.classList.add('blurred');
            
            // Mostrar modal y overlay
            cartModal.classList.add('active');
            cartOverlay.classList.add('active');
            
            // Actualizar contenido del carrito
            updateCartDisplay();
        }

        // Cerrar carrito
        function closeCart() {
            const cartModal = document.querySelector('.cart-modal');
            const cartOverlay = document.querySelector('.cart-modal-overlay');
            const background = document.querySelector('.background');
            
            // Quitar blur del fondo
            background.classList.remove('blurred');
            
            // Ocultar modal y overlay
            cartModal.classList.remove('active');
            cartOverlay.classList.remove('active');
        }

        // Actualizar visualización del carrito
        function updateCartDisplay() {
            const cartItemsContainer = document.getElementById('cart-items');
            const cartTotalElement = document.getElementById('cart-total');
            
            // Limpiar contenedor
            cartItemsContainer.innerHTML = '';
            
            // Calcular total
            cartTotal = 0;
            
            if (cartItems.length === 0) {
                // Mostrar mensaje de carrito vacío
                cartItemsContainer.innerHTML = `
                    <div class="empty-cart">
                        <div class="empty-cart-icon">🛒</div>
                        <p>Tu carrito está vacío</p>
                    </div>
                `;
            } else {
                // Mostrar elementos del carrito
                cartItems.forEach((item, index) => {
                    const itemTotal = item.price * item.quantity;
                    cartTotal += itemTotal;
                    
                    const cartItemElement = document.createElement('div');
                    cartItemElement.className = 'cart-item';
                    cartItemElement.innerHTML = `
                        <div class="cart-item-image">
                            <img src="${item.imageUrl}" alt="${item.name}">
                        </div>
                        <div class="cart-item-details">
                            <div class="cart-item-name">${item.name}</div>
                            <div class="cart-item-price">$${item.price.toFixed(2)} c/u</div>
                        </div>
                        <div class="cart-item-controls">
                            <button class="quantity-btn remove" onclick="decreaseQuantity(${index})">-</button>
                            <span class="item-quantity">${item.quantity}</span>
                            <button class="quantity-btn" onclick="increaseQuantity(${index})">+</button>
                        </div>
                    `;
                    
                    cartItemsContainer.appendChild(cartItemElement);
                });
            }
            
            // Actualizar total
            cartTotalElement.textContent = cartTotal.toFixed(2);
        }

        // Aumentar cantidad de un producto
        function increaseQuantity(index) {
            cartItems[index].quantity += 1;
            updateCartCount();
            updateCartDisplay();
        }

        // Disminuir cantidad de un producto
        function decreaseQuantity(index) {
            if (cartItems[index].quantity > 1) {
                cartItems[index].quantity -= 1;
            } else {
                // Si la cantidad es 1, eliminar producto
                cartItems.splice(index, 1);
            }
            updateCartCount();
            updateCartDisplay();
        }

        // Finalizar compra
        function checkout() {
            if (cartItems.length === 0) {
                alert('Tu carrito está vacío');
                return;
            }
            
            alert(`¡Gracias por tu compra! Total: $${cartTotal.toFixed(2)}`);
            
            // Vaciar carrito
            cartItems = [];
            updateCartCount();
            updateCartDisplay();
            closeCart();
        }

        // Cerrar con ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeExpanded();
                closeCart();
            }
        });
    </script>
</body>
</html>